# MacWallpaper 快速参考

## 🚀 快速开始

### 首次使用

1. **启动应用**
   ```bash
   swift run
   ```

2. **添加壁纸**
   - 点击 "+" 添加单个视频
   - 点击 "文件夹+" 批量导入

3. **应用壁纸**
   - 双击任意壁纸
   - 自动启用动态壁纸功能

## 📋 操作速查

### 壁纸管理

| 操作 | 方式 |
|------|------|
| **选择壁纸** | 单击壁纸缩略图 |
| **应用壁纸** | 双击壁纸 / 右键 → 应用 |
| **添加收藏** | 右键 → 添加到喜欢 ⭐ |
| **取消收藏** | 右键 → 取消喜欢 |
| **删除壁纸** | 右键 → 删除 |
| **批量导入** | 工具栏 → 文件夹+ |
| **查看详情** | 单击后右侧显示检查器 |
| **关闭检查器** | 点击空白区域 |

### 壁纸控制

| 功能 | 位置 | 说明 |
|------|------|------|
| **启用/禁用** | 检查器 / 状态栏 | 总开关，禁用后无黑屏 |
| **静音控制** | 检查器 / 状态栏 | 关闭视频声音 |
| **播放质量** | 检查器 | 低/中/高/原始 |
| **当前壁纸** | 壁纸库 | 🟢 绿色圆点标记 |
| **收藏壁纸** | 壁纸库 | ⭐ 黄色星星标记 |

### 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| `⌘Q` | 退出应用 |

## 🎯 常见场景

### 场景 1: 首次启动应用

**操作流程**:
1. 启动应用 → 默认**禁用壁纸**（无黑屏）
2. 添加壁纸 → 工具栏"+"或"文件夹+"
3. 双击任意壁纸 → 自动启用并应用

**智能启动**: 第二次启动自动恢复上次壁纸 ✨

---

### 场景 2: 临时关闭壁纸

**问题**: 不想删除壁纸，但希望暂时关闭动态壁纸

**解决方案**:
1. 方式一: 状态栏 → 点击"停用壁纸"
2. 方式二: 单击壁纸 → 检查器 → 取消勾选"启用壁纸"

**效果**: 壁纸窗口关闭，恢复系统默认桌面

**下次启动**: 记住禁用状态，不会自动启动 ✅

---

### 场景 3: 更换壁纸

**快速方式**:
```
双击新壁纸 → 自动应用 ✅
```

**详细方式**:
```
1. 单击壁纸查看预览
2. 检查器中调整设置
3. 点击"应用壁纸"按钮
```

---

### 场景 4: 收藏常用壁纸

**目标**: 标记喜欢的壁纸，方便查找

**操作**:
1. 右键壁纸 → 点击"添加到喜欢"
2. 壁纸右上角出现⭐黄色星星

**效果**: 收藏的壁纸自动排在最前面

**取消**: 右键 → 点击"取消喜欢"

---

### 场景 5: 批量导入视频

**操作**:
1. 点击工具栏 "文件夹+" 按钮
2. 选择包含视频的文件夹
3. 自动递归扫描所有 `.mp4`, `.mov`, `.m4v`

**示例文件夹结构**:
```
Movies/
├── Wallpapers/
│   ├── nature/
│   │   ├── ocean.mp4      ✅
│   │   └── forest.mov     ✅
│   └── abstract/
│       ├── particles.mp4  ✅
│       └── readme.txt     ❌
```

导入结果: 3 个视频

---

### 场景 6: 识别当前壁纸

**视觉标识**:
- 🟢 绿色圆点（左上角）
- 🟢 淡绿色边框

**技巧**: 壁纸库中快速定位正在使用的壁纸

---

### 场景 7: 智能排序

**自动排序规则**:
```
1️⃣ 收藏的壁纸（⭐黄色星星）
2️⃣ 最近播放的壁纸
3️⃣ 最新添加的壁纸
```

**无需手动整理**: 添加收藏或播放后自动重排 ✨

---

## ⚙️ 状态栏功能

右键点击状态栏图标:

```
┌─────────────────────────┐
│ 打开主窗口              │ ← 显示壁纸库
├─────────────────────────┤
│ 停用壁纸                │ ← 总开关（文字动态变化）
│ ☐ 静音                  │ ← 音频开关
├─────────────────────────┤
│ 隐藏 Dock 图标          │ ← 切换显示
├─────────────────────────┤
│ 关于 MacWallpaper       │
│ 退出                    │ ⌘Q
└─────────────────────────┘
```

**动态文字**: 
- 禁用时显示 "启用壁纸"
- 启用时显示 "停用壁纸"

## 🔍 检查器面板

单击壁纸后右侧显示:

```
┌──────────────────────┐
│   [缩略图预览]  ⭐    │ ← 收藏标记
│                      │
│   壁纸名称           │
│                      │
│  [应用壁纸] 按钮     │
│                      │
├──────────────────────┤
│ 启用壁纸:      ☑     │
│ 静音:          ☐     │
│ 质量:         [高▼]  │
└──────────────────────┘
```

**指示器说明**:
- 🟢 绿色圆点 = 当前应用的壁纸
- ⭐ 黄色星星 = 收藏的壁纸

**提示**: 点击空白区域自动隐藏

## 🐛 故障排除

### 问题: 壁纸无画面有声音

**原因**: 窗口层级问题（已修复 ✅）

**检查**:
1. 确认"启用壁纸"已勾选
2. 重新应用壁纸（双击）
3. 检查视频文件是否损坏

---

### 问题: 点击壁纸无反应

**检查**:
1. 确认是单击（选中）还是双击（应用）
2. 查看检查器是否弹出（右侧滑入）
3. 尝试点击其他壁纸

---

### 问题: 启动后桌面全黑

**解决**:
1. 状态栏 → 点击"停用壁纸"
2. 或重启应用（默认禁用壁纸 ✅）

**注意**: v0.2.0 已修复，首次启动默认禁用

---

### 问题: 找不到上次用的壁纸

**自动恢复**: 
- 启用壁纸后自动加载上次播放的壁纸
- 如果上次壁纸被删除，自动播放：收藏 > 最近播放 > 首个

**手动查找**:
- 查看绿色圆点🟢标记（当前壁纸）
- 收藏的壁纸自动排在最前面

---

## 💡 最佳实践

### 1. 文件组织
```
~/Movies/
└── Wallpapers/
    ├── 风景/
    ├── 抽象/
    ├── 动物/
    └── 太空/
```

### 2. 视频格式
- ✅ **推荐**: MP4 (H.264)
- ✅ **支持**: MOV, M4V
- ⚠️ **避免**: 超大文件 (>500MB)

### 3. 性能优化
- 使用"低"或"中"质量
- 启用静音（如不需要声音）
- 定期清理不用的壁纸

### 4. 使用习惯
- **首次启动**: 默认禁用，导入壁纸后双击应用
- **切换壁纸**: 直接双击，无需先禁用
- **临时关闭**: 用"停用壁纸"开关，不要删除壁纸
- **标记收藏**: 常用壁纸右键添加喜欢，自动排前面

### 5. 智能功能
- **自动记忆**: 记住上次播放的壁纸和启用状态
- **智能排序**: 收藏 > 最近播放 > 添加时间
- **自动恢复**: 启动时自动加载上次壁纸
- **零配置**: 所有智能功能自动工作

---

## 🎨 设计理念

### "Good Taste" 原则
- 单击 = 选择
- 双击 = 应用
- 右键 = 菜单（应用/收藏/删除）

**没有模糊地带，没有意外行为**

**智能排序**:
```
收藏的壁纸 ⭐
    ↓
最近播放的壁纸 🕒
    ↓
其他壁纸
```

### "Never Break Userspace"
- 壁纸库自动保存
- 设置持久化
- 升级不丢失数据

### 实用主义
- 解决真问题
  - 黑屏 → 禁用功能 + 延迟创建窗口
  - 崩溃 → 修复窗口创建时机
  - 找不到壁纸 → 智能排序 + 收藏功能
- 性能优先（延迟加载窗口）
- 用户友好
  - 🟢 绿点 = 当前壁纸
  - ⭐ 星星 = 收藏壁纸
  - 智能记忆上次播放

---

## 📦 技术信息

### 系统要求
- macOS 12.0+
- Swift 6.2+

### 支持格式
- MP4 (MPEG-4)
- MOV (QuickTime)
- M4V (iTunes)

### 数据存储
- 位置: `UserDefaults`
- 键: `SavedWallpapers`
- 格式: JSON

---

## 🚨 重要提示

1. **首次使用默认禁用壁纸** ✅
   - 避免未选择壁纸时黑屏
   - 双击壁纸后自动启用
   - 下次启动自动恢复上次状态

2. **检查器自动隐藏** ✅
   - 点击空白区域关闭
   - 不会自动弹出
   - 单击壁纸时显示

3. **当前壁纸标识** 🟢
   - 绿色圆点（左上角）
   - 淡绿色边框
   - 即使禁用壁纸也显示

4. **收藏功能** ⭐
   - 黄色星星标记
   - 自动排在最前面
   - 右键添加/取消喜欢

5. **智能记忆** 🧠
   - 记住上次播放的壁纸
   - 记住启用/禁用状态
   - 记住收藏列表
   - 所有数据自动保存

---

**Built with Good Taste™** 🎨